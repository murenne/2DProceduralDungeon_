# 2DProceduralDungeon

[English](./README.md) | [中文](./README_cn.md) | [日本語](./README_jp.md)

これは軽量でシンプルなダンジョン生成プロジェクトです。
私がUnityを学び始めた当初に制作した最初のプロジェクトになります。
時間をかけて完全にリファクタリングを行い、オープンソース化しました。Unity初心者の方の参考になれば幸いです。

## Tech Stack

| カテゴリ | テクノロジー | バージョン | 説明 |
| :--- | :--- | :--- | :--- |
| **ゲームエンジン** | Unity | 2022.3.36f1 | コアゲーム開発エンジン |
| **レンダーパイプライン** | Built-in Render Pipeline | 内蔵 | デフォルトのレンダリングパイプライン |
| **アニメーション** | 2D Animation | 9.1.1 | 2D骨格アニメーションおよびリギングツール |
| **アルゴリズム** | ランダムウォーク | - | プロシージャル（手続き型）マップ生成アルゴリズム |
| **アルゴリズム** | A*（エースター）経路探索（簡易版） | - | 連結性チェックおよび敵の経路探索 |

---

* [2D Simple Dungeon Generator](#2DProceduralDungeon)
    * [Tech Stack](#tech-stack)
    * [Getting Started](#getting-started)
    * [Control](#control)
    * [Attack](#attack)
        * [Basic Attack](#basic-attack)
        * [Magic Attack](#magic-attack)
    * [Dialog](#dialog)
        * [Text](#text)
        * [Icon](#icon)
    * [Dungeon Generator](#dungeon-generator)
        * [Basic Room](#basic-room)
        * [Door](#door)
        * [Boss Room](#boss-room)
    * [Map](#map)
        * [Room position](#room-position)
        * [Player Position](#player-position)
    * [Camera](#camera)
    * [Status](#status)
    * [Level](#level)
    * [Item](#item)
        * [Golden Coin](#golden-coin)
        * [Herbs](#herbs)
        * [Bottle](#bottle)
    * [Enemy](#enemy)
        * [Bat](#bat)
        * [Fire ball](#fire-ball)
        * [Wizard](#wizard)
        * [Knight](#knight)
    * [UI](#ui)
        * [Player UI](#player-ui)
            * [HP bar](#hp-bar)
            * [Experience bar](#experience-bar)
            * [Items Count](#items-count)
        * [Enemy UI](#enemy-ui)
            * [HP bar](#hp-bar-1)
            * [Damage Number](#damage-number)
    * [Statement](#statement)
## Getting Started
1. 本プロジェクトは **Unity 2022.3.36f1** をベースに開発されています。Unityのバージョンが **2022.3.36f1** 以上であることを確認してください。
2. GitHubからプロジェクトを指定のフォルダにクローンし、Unityで開きます。
3. Unityエディタ上部の **Play** ボタンをクリックすると、プロジェクトが実行されます。

## Control
本プロジェクトは**キーボードとマウス**のみサポートしており、ゲームパッド（コントローラー）には対応していません。

| キー | 説明 |
| :--- | :--- |
| `WASD` | プレイヤー移動 |
| `マウス左クリック` | 通常攻撃 |
| `マウス右クリック` | 魔法攻撃 |
| `B` | 会話開始 |
| `Q` | 回復薬を使用 |
| `M` | マップを開く |

---

## Attack
本プロジェクトには、通常攻撃と魔法攻撃の2種類の攻撃方法があります。

![Attack](./README_Images/Attack.gif)

### Basic Attack
通常攻撃は近接攻撃で、キャラクターの周囲を薙ぎ払います。攻撃角度はマウスの位置に基づいて決定されます。クールダウン（待機時間）はありません。

### Magic Attack
魔法攻撃は遠距離攻撃で、射程は画面全体に及びます。攻撃地点はマウスの位置に基づいて決定されます。クールダウンがあります。

---

## Dialog
本プロジェクトには簡易的な会話システムがあり、`.txt`ファイルの内容を読み込んで会話を再生したり、キャラクターのアイコンを切り替えたりできます。

![Dialog](./README_Images/Dialog.gif)

### Text
テキスト内容は`.txt`ファイル内に記述されています。表示速度を制御することで、タイプライターのような演出を実現しています。

### Icon
アイコン情報も`.txt`ファイル内に記述されています。コードで指定されたキャラクターの顔グラフィックに切り替える機能を実装しています。

---

## Dungeon Generator
本プロジェクトには簡易的なダンジョン生成機能があり、合計10個の部屋が生成されます。
**ランダムウォーク（酔歩）アルゴリズム**と隣接検知を利用して部屋と壁を構築し、経路探索とフィルタリングアルゴリズムでボスの部屋（終点）を決定します。

![Dungeon](./README_Images/Dungeon.png)

### Basic Room
通常の部屋はランダムウォークアルゴリズムに基づいて構成されるため、生成されるたびに形状が異なります。
部屋には床、壁、開閉可能なドア、そして少数の雑魚敵が配置されます。
敵の種類と数はランダムに生成され、部屋ごとに異なります。

### Door
部屋に入ると、その部屋のすべてのドアが自動的に閉まります。
部屋内のすべての敵を倒すと、ドアは自動的に開きます。

### Boss Room
ボス部屋は終点となる部屋で、開始部屋から（歩数的に）最も遠い距離にある部屋が選ばれます。
ボス部屋には通常の部屋の構成に加え、ボス敵が1体追加で生成されます。

---

## Map
ダンジョンに入った後は、いつでも簡易マップを開くことができます。
簡易マップでは、現在までに通過した部屋と現在のプレイヤーの位置を確認できます。
まだ訪れていない部屋は表示されません。

![Map](./README_Images/Map.gif)

### Room position
白い四角形で部屋の位置を表示します。

### Player Position
赤い点でプレイヤーの位置を表示します。

---

## Camera
本プロジェクトは2D見下ろし型（トップダウン）のゲームです。
キャラクターが部屋に入ると、カメラはその部屋に固定されます。
部屋内でキャラクターが移動しても、カメラは追従しません。
キャラクターが新しい部屋に移動すると、カメラは自動的にその部屋へ移動します。
キャラクターの攻撃時や被弾時には、カメラの振動（シェイク）効果が発生します。

![Camera](./README_Images/Camera.gif)

---

## Status
キャラクターには4つのステータスがあり、レベルアップに伴い数値が徐々に増加します。

| 属性名 | 説明 |
| :--- | :--- |
| **ATK** | プレイヤー物理攻撃力 |
| **DEF** | プレイヤー物理防御力 |
| **MATK** | プレイヤー魔法攻撃力 |
| **MDEF** | プレイヤー魔法防御力 |

---

## Level
本プロジェクトには簡易的なレベルアップモジュールがあります。
敵を倒すと経験値を獲得し、経験値が必要量に達するとレベルアップします。
各レベルに必要な経験値は異なります。
レベルアップごとに増加するステータス値も異なります。

---

## Item
本プロジェクトには3種類のアイテム（金貨、薬草、回復薬）があります。
キャラクターとアイテムの位置が重なると、自動的に拾うか使用します。

![Item](./README_Images/Item.png)

### Golden Coin
金貨は単純なドロップアイテムであり、現在は使用できません。

### Herbs
薬草はHP回復アイテムです。拾うと自動的に使用され、HPを少量回復します。

### Bottle
回復薬（ボトル）はHP回復アイテムです。拾うと所持品に追加され、手動で使用（`Q`キー）する必要があります。HPを大幅に回復します。

---

## Enemy
本プロジェクトには4種類の敵が存在します。
3種類の通常の敵と1体のボスで構成されています。
敵ごとに攻撃パターンが異なります。

![Enemy](./README_Images/Enemy.gif)

### Bat
プレイヤーがコウモリの追跡範囲に入ると、自動的にプレイヤーを追いかけます。

### Fire ball
プレイヤーが追跡範囲に入ると、自動的にプレイヤーを追いかけ、一定時間ごとにプレイヤーを追尾する火の玉を吐き出します。
火の玉はプレイヤーや壁に当たると消滅します。何にも当たらなかった場合でも数秒で自動的に消滅します。

### Wizard
上記の2種類の敵とは異なり、ウィザード（魔法使い）は部屋内をランダムに移動します。
プレイヤーが追跡範囲に入るとプレイヤーを追いかけ、一定時間ごとにプレイヤーを追尾する火の玉を吐き出します。

### Knight
最後の部屋に存在するボスです。
近接攻撃を行います。

---

## UI
本プロジェクトには、プレイヤーUIと敵UIを含む簡易的なUI設定があります。

![UI](./README_Images/UI.png)

### Player UI
プレイヤーUIは主に3つの部分に分かれています：左上のHPバー、左側の経験値と魔法エネルギーバー、右上のアイテム数量です。

#### HP bar
プレイヤーのHPをリアルタイムで更新します。HPが0になるとプレイヤーは死亡します。

#### Experience bar
経験値をリアルタイムで更新します。現在のレベルに必要な経験値に達するとレベルアップし、経験値バーはリセットされます。

#### Items Count
現在所持しているアイテムの数をリアルタイムで表示します。
アイテムを使用すると、対応する数が減少します。

### Enemy UI
敵UIは主に2つの部分に分かれています：敵のHPバーとダメージ数値です。

#### HP bar (Enemy)
敵がダメージを受けた際に、現在のHPを表示します。

#### Damage Number
敵がダメージを受けた際、そのダメージ値を表示します。数値は上に浮かび上がりながらゆっくりと消えていきます。

---

## Statement
このプロジェクトは全体として正常に動作します。
しかし、時間と労力が限られていたため、私が発見していないバグが存在する可能性があります。
もしバグを見つけた場合は、Issues（課題）に投稿してください。
時間があるときに対応させていただきます。
ありがとうございます。